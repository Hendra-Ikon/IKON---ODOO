<?xml version="1.0" encoding="UTF-8" ?>
<templates>
    <t t-name="ikon_employee.Timesheet" owl="1">

        <Layout display="display">
            <div class="wrapper">
                <div class="top">
                    <t t-if="toggleData.weekLeft">
                        <h3 class="heading-title">
                            Timesheet for Week
                        </h3>

                        <h3 class="choosenDates" name="startDates" id="startDates">
                            <t t-esc="timesheet_date_header"/>

                        </h3>
                    </t>
                    <t t-else="">

                        <h3 class="heading-title">
                            Timesheet for Week
                        </h3>

                        <select class="startDates" name="startDates" id="startDates">
                            <t t-foreach="weekData" t-as="date" t-key="date_index">
                                <option t-att-value="date.range" style="overflow:hidden;">
                                    <t t-esc="date.range"/>
                                </option>
                            </t>

                        </select>
                    </t>

                </div>
                <form class="timesheetForm" id="timesheetForm">
                    <div class="tableWrapper" style="overflow:auto">
                        <table style="width:100%" class="table">
                            <thead>
                                <tr>
                                    <th style="width:2%" class="center">
                                        <input type="checkbox" style="display:none"/>
                                    </th>
                                    <th style="width:24%" id="projectName">Project Name</th>
                                    <th style="width:18%" id="activityName">Activity Name</th>
                                    <t t-if="usedData">

                                        <t t-foreach="usedData" t-as="day" t-key="day.id">
                                            <th class="center" style="width:8%">
                                                <t t-esc="formatDateheader(day.date)"/>
                                            </th>
                                        </t>
                                    </t>

                                    <!--                                    <t t-if="!timesheet_data.date">-->
                                    <!--                                        <th class="center" style="width:8%">-->
                                    <!--                                            <p>HALOO</p>-->
                                    <!--                                        </th>-->
                                    <!--                                    </t>-->


                                </tr>
                            </thead>
                            <t t-if="toggleData.weekLeft">
                                <tbody>
                                    <tr class="odd">
                                        <td id="">
                                            <input class="toDelete" type="checkbox" name="initialRows[0][toDelete]"
                                                   id="initialRows_0_toDelete"/>
                                        </td>
                                        <td>
                                            <div class="projectInputWrapper">
                                                <input type="text" class="projectSearch" style="width:225px"
                                                       placeholder="Search for a project..." id="projectSearch"
                                                       name="projectSearch"/>

                                                <ul class="list-group" style="width:225px">
                                                    <t t-foreach="timesheet_data.project" t-as="project"
                                                       t-key="project.id">
                                                        <li class="list-group-item" t-att-value="project.id">
                                                                <t t-esc="project.name"/>
                                                        </li>
                                                    </t>
                                                </ul>
                                            </div>
                                        </td>

                                        <td>
                                            <select class="projectActivity" style="width:225px"
                                                    name="activityProject"
                                                    id="initialRows_0_projectActivityName">
                                                <option value="-1">-- Select --</option>
                                                <t t-foreach="select_activity" t-as="activity"
                                                   t-key="activity_index">
                                                    <option t-att-value="activity.id">
                                                        <t t-esc="activity.name"/>
                                                    </option>
                                                </t>
                                            </select>
                                            <input type="hidden" name="initialRows[0][projectActivityId]"
                                                   id="initialRows_0_projectActivityId"/>
                                        </td>

                                        <t t-foreach="usedData" t-as="hour" t-key="hour.id">
                                            <td class="comments">
                                                <div class="comment_wrapper">
                                                    <input align="center" class="timeBox" type="text"
                                                           name="initialRows[0][0]"
                                                           id="initialRows_0_0" t-model="hour.unit_amount" value=""/>
                                                    <img class="commentIcon" data-bs-toggle="modal"
                                                         t-att-data-bs-target="'#exampleModal' + hour.id"
                                                         src="/ikon_recruitment/static/src/img/comment.png"/>
                                                    <input type="hidden" name="taskId" t-model="state.task_id"
                                                           t-att-value="'1'"
                                                           value="'1'" id="taskId"/>
                                                    <input type="hidden" name="projectId" t-model="state.project_id"
                                                           t-attf-value="dataProjectId" value="dataProjectId"
                                                           id="projectId"/>
                                                    <input type="hidden" name="dataId" t-model="hour.id"
                                                           t-attf-value="hour.id" value="hour.id" id="projectId"/>
                                                    <input type="hidden" name="dateId" t-model="hour.date"
                                                           t-attf-value="hour.date" value="hour.date" id="projectId"/>

                                                    <!-- Modal Popup for each task -->
                                                    <div class="modal fade" t-att-id="'exampleModal' + hour.id"
                                                         tabindex="-1"
                                                         aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h1 class="modal-title fs-5" id="exampleModalLabel">
                                                                        Add
                                                                        New
                                                                        Task
                                                                    </h1>
                                                                    <button type="button" class="btn-close"
                                                                            data-bs-dismiss="modal"
                                                                            aria-label="Close"></button>
                                                                </div>
                                                                <div class="modal-body">
                                                                    <div class="mb-3 row">
                                                                        <label for="name"
                                                                               class="col-sm-2 col-form-label">
                                                                            Task
                                                                            Description
                                                                        </label>
                                                                        <div class="col-sm-10">
                                                                            <input type="text" class="form-control"
                                                                                   t-att-id="'description' + hour.id"
                                                                                   t-model="hour.name"
                                                                                   value="{{ hour.name }}"/>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <div class="modal-footer">
                                                                    <button type="button" class="btn btn-secondary"
                                                                            data-bs-dismiss="modal">Close
                                                                    </button>
                                                                    <button type="button" class="btn btn-primary"
                                                                            t-on-click="() => saveDescription(hour)">
                                                                        Save
                                                                        changes
                                                                    </button>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </td>
                                        </t>

                                    </tr>
                                </tbody>
                            </t>
                            <t t-else="">
                                <div class="no-record">
                                    No Records to display
                                </div>

                            </t>

                            <tr id="extraRows" style="display: none;"></tr>


                        </table>
                    </div>

                    <div class="bottom">
                        <p class="required">
                            <em>*</em>
                            Deleted project activities are not editable
                        </p>
                        <p class="button-list">

                            <!--                        <input type="button" class="delete" id="submitRemoveRows" value="Remove Rows"-->
                            <!--                               name="btnRemoveRows"/>-->
                            <t t-if="toggleData.weekLeft">
                                <input type="submit" class="submit" value="Save" name="btnSave" id="submitSave"
                                       t-on-click="() => send(state, usedData)"/>
                                <input class="reset" id="btnReset" value="Reset" type="button"
                                       onclick="document.location.href='/ikonhrm/symfony/web/index.php/time/editTimesheet/timesheetId/23014/employeeId/279/actionName/viewMyTimesheet';"/>
                                <input class="cancel" id="btnBack" value="Cancel" type="button"
                                       t-on-click="() => cancel()"/>
                            </t>
                            <t t-else="">
                                <input type="button" class="edit" id="btnAddRow" value="Edit" name="btnEdit"
                                       t-on-click="() => edit()"/>
                            </t>
                        </p>

                    </div>
                </form>
            </div>
        </Layout>
    </t>

</templates>
